{% extends "./base_with_nav.html" %} 
{% load admin_utils %} 

{% block content_header %}
<ul class="paas-breadcrumb">
    <li class="active">{{ view.name }}</li>
</ul>
{% endblock %} 

{% block nav_list %}
<script>
    var navList = [
        {% get_user_site_perms as perm %}

        {% if perm.manage_platform %}
        {
            name: '配置管理',
            children: [
                {
                    name: '应用列表',
                    icon: 'icon-block-shape',
                    url: "{% url 'admin.applications.list' %}",
                },
                {
                    name: '运行时管理',
                    icon: 'icon-block-shape',
                    url: "{% url 'admin.runtimes.buildpack.manage' %}",
                    children: [
                        {
                            name: 'BuildPack 管理',
                            url: '{% url "admin.runtimes.buildpack.manage" %}',
                        },
                        {
                            name: 'SlugBuilder 管理',
                            url: '{% url "admin.runtimes.slugbuilder.manage" %}',
                        },
                        {
                            name: 'SlugRunner 管理',
                            url: '{% url "admin.runtimes.slugrunner.manage" %}',
                        },
                    ],
                },
                {
                    name: '应用资源方案',
                    icon: 'icon-block-shape',
                    url: '{% url "admin.process_spec_plan.manage" %}',
                    children: [
                        {
                            name: '方案列表',
                            url: '{% url "admin.process_spec_plan.manage" %}',
                        },
                        {
                            name: '方案配置',
                            url: '{% url "admin.process_spec_plan.applications.manage" %}',
                        },
                    ],
                },
                {
                    name: '智能顾问',
                    icon: 'icon-block-shape',
                    url: "{% url 'admin.smart_advisor.documents.manage' %}",
                    children: [
                        {
                            name: '文档管理',
                            url: '{% url "admin.smart_advisor.documents.manage" %}',
                        },
                        {
                            name: '失败提示管理',
                            url: '{% url "admin.smart_advisor.deploy_failure_tips.manage" %}',
                        },
                    ],
                },
                {
                    name: '共享证书管理',
                    icon: 'icon-block-shape',
                    url: "{% url 'admin.shared.certs.manage' %}",
                },
                {% if perm.manage_app_templates %}
                    {
                        name: '仪表盘模板配置',
                        icon: 'icon-block-shape',
                        url: "{% url 'admin.configuration.dashboard_tmpl.manage' %}",
                    },
                    {
                        name: '插件配置',
                        icon: 'icon-block-shape',
                        url: "{% url 'admin.configuration.bk_plugins.tags.manage' %}",
                        children: [
                            {
                                name: '插件分类配置',
                                url: "{% url 'admin.configuration.bk_plugins.tags.manage' %}",
                            },
                            {
                                name: '插件使用方配置',
                                url: "{% url 'admin.configuration.bk_plugins.distributors.manage' %}",
                            },
                        ],
                    },
                {% endif %}
            ],
        },
        {
            name: '运营管理',
            children: [
                {
                    name: '应用运营评估',
                    icon: 'icon-block-shape',
                    url: "{% url 'admin.applications.operation_evaluation.list' %}",
                },
                {
                    name: '部署概览',
                    icon: 'icon-block-shape',
                    url: "{% url 'admin.deployments.list' %}",
                },
                {% if perm.operate_platform %}
                    {% url 'admin.operation.index' as operation_index_view %}
                    {% if operation_index_view %}
                    {
                        name: '应用统计',
                        icon: 'icon-block-shape',
                        url: "{% url 'admin.operation.mgrlegacy.progress' %}",
                        children: [
                            {
                                name: "应用迁移进展",
                                url: "{% url 'admin.operation.mgrlegacy.progress' %}"
                            },
                            {
                                name: '应用部署统计',
                                url: "{% url 'admin.operation.statistics.deploy.apps' %}",
                            },
                            {
                                name: "开发者部署统计",
                                url: "{% url 'admin.operation.statistics.deploy.developers' %}"
                            },
                        ],
                    },
                    {% endif %}
                {% endif %}
            ],
        },
        {% endif %}

        {% if perm.manage_platform %}
            {% if not AUTO_CREATE_REGULAR_USER %}
            // 如果平台不在用户登录的时候自动创建用户，则需要在用户列表中将用户添加为普通用户后，用户才能访问开发者中心
                {
                    name: '用户管理',
                    children: [
                        {
                            name: '用户列表',
                            icon: 'icon-block-shape',
                            url: "{% url 'admin.accountmgr.userprofiles.index' %}",
                        },
                    ],
                },
            {% endif %}
        {% endif %}
    ];
</script>
{% endblock %}
